============================================
ğŸ“¤ UPLOAD 3000 QUESTIONS TO SUPABASE
============================================

WHAT I UPDATED:
---------------

âœ… Updated upload script to use service_role key (bypasses RLS)
âœ… Added automatic normalization:
   - Skills: "HTML" â†’ "html", "OGL Knowledge" â†’ "oglknowledge"
   - Levels: "BASIC" â†’ "easy", "INTERMEDIATE" â†’ "medium", "ADVANCED" â†’ "hard"
   - Types: "Multiple Choice" â†’ "mcq", "Fill in the Blank" â†’ "fill_blank"
âœ… Added --clear option to delete existing questions first

OPTION 1: UPLOAD WITHOUT CLEARING (RECOMMENDED)
------------------------------------------------

This will ADD the 3000 questions to your existing 8 questions:

1. Open terminal in project root

2. Run:
   npx tsx scripts/upload-csv-to-supabase.ts client/dist/assets/ogl_developer_questions_combined_3000_cleaned.csv

3. Wait for upload (takes 3-5 minutes)

4. Should see:
   ğŸ“Š Found 3000 questions in CSV
   ğŸ“¦ Processing batch 1/30 (100 questions)
   âœ… Uploaded 100 questions
   ğŸ“Š Progress: 3% (100/3000)
   ...
   âœ… Upload Complete!
   Total uploaded: 3000

OPTION 2: CLEAR AND UPLOAD (FRESH START)
-----------------------------------------

This will DELETE all existing questions and upload fresh:

1. Open terminal in project root

2. Run:
   npx tsx scripts/upload-csv-to-supabase.ts client/dist/assets/ogl_developer_questions_combined_3000_cleaned.csv --clear

3. Wait for upload

4. Should see:
   ğŸ—‘ï¸  Clearing existing questions...
   âœ… Existing questions cleared
   ğŸ“Š Found 3000 questions in CSV
   ...

WHAT HAPPENS DURING UPLOAD:
----------------------------

1. Script reads CSV file (3000 questions)
2. Processes in batches of 100 (to avoid timeouts)
3. For each question:
   - Normalizes skill name (lowercase, no spaces)
   - Converts level (BASICâ†’easy, etc.)
   - Converts type (Multiple Choiceâ†’mcq)
   - Generates unique question_id
   - Inserts into Supabase
4. Shows progress every batch
5. Final summary at end

EXPECTED RESULT:
----------------

After upload, you should have:

HTML:
- easy: ~500 questions
- medium: ~500 questions
- hard: ~500 questions

CSS:
- easy: ~300 questions
- medium: ~300 questions
- hard: ~300 questions

JavaScript:
- easy: ~400 questions
- medium: ~400 questions
- hard: ~400 questions

jQuery:
- easy: ~100 questions
- medium: ~100 questions
- hard: ~100 questions

OGL Knowledge:
- easy: ~50 questions
- medium: ~50 questions
- hard: ~50 questions

(Numbers are approximate based on CSV content)

VERIFY UPLOAD:
--------------

After upload completes, run this in Supabase SQL Editor:

SELECT skill, level, COUNT(*) as count 
FROM questions 
GROUP BY skill, level 
ORDER BY skill, level;

Should show all skills with their question counts.

TROUBLESHOOTING:
----------------

âŒ "Cannot find module 'papaparse'"
   â†’ Run: npm install papaparse
   â†’ Run: npm install @types/papaparse --save-dev

âŒ "Cannot find module '@supabase/supabase-js'"
   â†’ Run: npm install @supabase/supabase-js

âŒ "Error: RLS policy violation"
   â†’ Script now uses service_role key, should work

âŒ Upload stops or hangs
   â†’ Check internet connection
   â†’ Try again, script will skip duplicates
   â†’ Use smaller batch size (edit BATCH_SIZE in script)

âŒ "Duplicate key value violates unique constraint"
   â†’ Some questions already exist
   â†’ Use --clear flag to start fresh
   â†’ Or script will skip duplicates and continue

AFTER UPLOAD:
-------------

1. Verify questions in database (see above)

2. Test the app:
   - Go to career page
   - Click "From Database" for any skill
   - Should load 10 questions now

3. All skills should work:
   - HTML: âœ…
   - CSS: âœ…
   - JavaScript: âœ…
   - jQuery: âœ…
   - OGL Knowledge: âœ…

NO CLEANUP NEEDED:
------------------

The upload script now normalizes everything automatically!
- No need to run cleanup SQL after
- Questions are inserted in correct format
- Ready to use immediately

COMMAND TO RUN NOW:
-------------------

cd to project root, then:

npx tsx scripts/upload-csv-to-supabase.ts client/dist/assets/ogl_developer_questions_combined_3000_cleaned.csv

That's it! Wait 3-5 minutes and you're done! ğŸš€
