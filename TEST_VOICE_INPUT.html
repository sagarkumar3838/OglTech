<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Input Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 5px;
            border-left: 4px solid #4CAF50;
        }
        .test-section.error {
            border-left-color: #f44336;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 5px;
            font-family: monospace;
        }
        .success {
            color: #4CAF50;
            font-weight: bold;
        }
        .error-text {
            color: #f44336;
            font-weight: bold;
        }
        button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #1976D2;
        }
        button.recording {
            background: #f44336;
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .info {
            background: #E3F2FD;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            border-left: 4px solid #2196F3;
        }
        input {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé§ Voice Input Test Page</h1>
        
        <div class="info">
            <strong>Purpose:</strong> This page tests if your browser supports Web Speech API (voice input).
            <br><br>
            <strong>Best browsers:</strong> Chrome, Edge, Safari
            <br>
            <strong>Limited support:</strong> Firefox
            <br>
            <strong>Not supported:</strong> Internet Explorer
        </div>

        <!-- Test 1: Browser Support -->
        <div class="test-section" id="test1">
            <h2>Test 1: Browser Support</h2>
            <p>Checking if your browser supports Web Speech API...</p>
            <div class="result" id="result1">Running test...</div>
        </div>

        <!-- Test 2: Browser Info -->
        <div class="test-section" id="test2">
            <h2>Test 2: Browser Information</h2>
            <div class="result" id="result2">Loading...</div>
        </div>

        <!-- Test 3: Voice Recognition Test -->
        <div class="test-section" id="test3">
            <h2>Test 3: Voice Recognition Test</h2>
            <p>Click the button below and speak into your microphone:</p>
            <button id="startBtn" onclick="startRecognition()">üé§ Start Recording</button>
            <button id="stopBtn" onclick="stopRecognition()" style="display:none;">‚èπÔ∏è Stop Recording</button>
            <div class="result" id="result3">Click "Start Recording" to test voice input</div>
            <input type="text" id="transcript" placeholder="Your speech will appear here..." readonly>
        </div>

        <!-- Test 4: Microphone Permission -->
        <div class="test-section" id="test4">
            <h2>Test 4: Microphone Permission</h2>
            <p>Check if microphone permission is granted:</p>
            <button onclick="checkMicPermission()">Check Microphone Permission</button>
            <div class="result" id="result4">Click button to check</div>
        </div>

        <!-- Instructions -->
        <div class="info">
            <h3>üìã What to Do:</h3>
            <ol>
                <li><strong>Check Test 1:</strong> If it says "NOT supported", use Chrome or Edge</li>
                <li><strong>Check Test 2:</strong> Verify you're using a supported browser</li>
                <li><strong>Try Test 3:</strong> Click "Start Recording" and speak</li>
                <li><strong>Check Test 4:</strong> Make sure microphone permission is granted</li>
            </ol>
            <br>
            <strong>If all tests pass but microphone still doesn't show on your app:</strong>
            <ol>
                <li>Clear browser cache (Ctrl + Shift + Delete)</li>
                <li>Hard refresh (Ctrl + F5)</li>
                <li>Try Incognito/Private mode</li>
            </ol>
        </div>
    </div>

    <script>
        let recognition = null;

        // Test 1: Check browser support
        function test1() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const result1 = document.getElementById('result1');
            const test1Div = document.getElementById('test1');
            
            if (SpeechRecognition) {
                result1.innerHTML = '<span class="success">‚úÖ SUCCESS!</span><br>Your browser supports Web Speech API!<br><br>SpeechRecognition: ' + (window.SpeechRecognition ? 'window.SpeechRecognition' : 'window.webkitSpeechRecognition');
                test1Div.classList.remove('error');
            } else {
                result1.innerHTML = '<span class="error-text">‚ùå NOT SUPPORTED</span><br>Your browser does NOT support Web Speech API.<br><br><strong>Solution:</strong> Please use Chrome, Edge, or Safari.';
                test1Div.classList.add('error');
            }
        }

        // Test 2: Browser info
        function test2() {
            const result2 = document.getElementById('result2');
            const userAgent = navigator.userAgent;
            let browserName = 'Unknown';
            
            if (userAgent.indexOf('Chrome') > -1 && userAgent.indexOf('Edg') === -1) {
                browserName = 'Google Chrome';
            } else if (userAgent.indexOf('Edg') > -1) {
                browserName = 'Microsoft Edge';
            } else if (userAgent.indexOf('Safari') > -1 && userAgent.indexOf('Chrome') === -1) {
                browserName = 'Safari';
            } else if (userAgent.indexOf('Firefox') > -1) {
                browserName = 'Firefox';
            } else if (userAgent.indexOf('MSIE') > -1 || userAgent.indexOf('Trident') > -1) {
                browserName = 'Internet Explorer';
            }
            
            result2.innerHTML = `
                <strong>Browser:</strong> ${browserName}<br>
                <strong>Platform:</strong> ${navigator.platform}<br>
                <strong>Language:</strong> ${navigator.language}<br>
                <strong>Online:</strong> ${navigator.onLine ? 'Yes' : 'No'}<br>
                <strong>HTTPS:</strong> ${window.location.protocol === 'https:' ? 'Yes ‚úÖ' : 'No ‚ùå (Voice input requires HTTPS)'}
            `;
        }

        // Test 3: Voice recognition
        function startRecognition() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const result3 = document.getElementById('result3');
            const transcript = document.getElementById('transcript');
            const startBtn = document.getElementById('startBtn');
            const stopBtn = document.getElementById('stopBtn');
            
            if (!SpeechRecognition) {
                result3.innerHTML = '<span class="error-text">‚ùå Cannot start: Browser does not support Web Speech API</span>';
                return;
            }
            
            try {
                recognition = new SpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'en-US';
                
                recognition.onstart = () => {
                    result3.innerHTML = '<span class="success">üé§ Recording... Speak now!</span>';
                    startBtn.style.display = 'none';
                    stopBtn.style.display = 'inline-block';
                    stopBtn.classList.add('recording');
                };
                
                recognition.onresult = (event) => {
                    const text = event.results[0][0].transcript;
                    transcript.value = text;
                    result3.innerHTML = '<span class="success">‚úÖ SUCCESS! Voice recognized!</span><br>You said: "' + text + '"';
                };
                
                recognition.onerror = (event) => {
                    result3.innerHTML = '<span class="error-text">‚ùå Error: ' + event.error + '</span><br><br>';
                    if (event.error === 'not-allowed') {
                        result3.innerHTML += 'Microphone permission denied. Please allow microphone access.';
                    } else if (event.error === 'no-speech') {
                        result3.innerHTML += 'No speech detected. Please try again.';
                    }
                    startBtn.style.display = 'inline-block';
                    stopBtn.style.display = 'none';
                };
                
                recognition.onend = () => {
                    startBtn.style.display = 'inline-block';
                    stopBtn.style.display = 'none';
                    stopBtn.classList.remove('recording');
                };
                
                recognition.start();
            } catch (error) {
                result3.innerHTML = '<span class="error-text">‚ùå Error starting recognition: ' + error.message + '</span>';
            }
        }

        function stopRecognition() {
            if (recognition) {
                recognition.stop();
            }
        }

        // Test 4: Microphone permission
        async function checkMicPermission() {
            const result4 = document.getElementById('result4');
            
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                stream.getTracks().forEach(track => track.stop());
                result4.innerHTML = '<span class="success">‚úÖ Microphone permission granted!</span><br>Your microphone is accessible.';
            } catch (error) {
                result4.innerHTML = '<span class="error-text">‚ùå Microphone permission denied or not available</span><br>Error: ' + error.message + '<br><br><strong>Solution:</strong> Click the lock icon in the address bar and allow microphone access.';
            }
        }

        // Run tests on page load
        window.onload = () => {
            test1();
            test2();
        };
    </script>
</body>
</html>
